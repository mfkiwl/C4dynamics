
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>C4dynamics &#8212; C4DYNAMICS v2.0</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=75c5c689"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'programs/dof6sim';</script>
    <link rel="icon" href="../_static/c4dlogo.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Nov 17, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">C4DYNAMICS v2.0</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Home
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/States.html">State Objects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/states.state.html">The state class</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/state/c4dynamics.states.state.state.X.html">c4dynamics.states.state.state.X</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/state/c4dynamics.states.state.state.X0.html">c4dynamics.states.state.state.X0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/state/c4dynamics.states.state.state.norm.html">c4dynamics.states.state.state.norm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/state/c4dynamics.states.state.state.normalize.html">c4dynamics.states.state.state.normalize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/state/c4dynamics.states.state.state.position.html">c4dynamics.states.state.state.position</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/state/c4dynamics.states.state.state.velocity.html">c4dynamics.states.state.state.velocity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/state/c4dynamics.states.state.state.addvars.html">c4dynamics.states.state.state.addvars</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/state/c4dynamics.states.state.state.P.html">c4dynamics.states.state.state.P</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/state/c4dynamics.states.state.state.V.html">c4dynamics.states.state.state.V</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/state/c4dynamics.states.state.state.store.html">c4dynamics.states.state.state.store</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/state/c4dynamics.states.state.state.storeparams.html">c4dynamics.states.state.state.storeparams</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/state/c4dynamics.states.state.state.data.html">c4dynamics.states.state.state.data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/state/c4dynamics.states.state.state.timestate.html">c4dynamics.states.state.state.timestate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/state/c4dynamics.states.state.state.plot.html">c4dynamics.states.state.state.plot</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/states.lib.html">States library</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/states.lib.datapoint.html">Datapoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/states.lib.rigidbody.html">Rigidbody</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/states.lib.pixelpoint.html">Pixelpoint</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/Sensors.html">Sensors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/sensors.seeker.html">Seeker</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/seeker/c4dynamics.sensors.seeker.seeker.bias.html">c4dynamics.sensors.seeker.seeker.bias</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/seeker/c4dynamics.sensors.seeker.seeker.scale_factor.html">c4dynamics.sensors.seeker.seeker.scale_factor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/seeker/c4dynamics.sensors.seeker.seeker.measure.html">c4dynamics.sensors.seeker.seeker.measure</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/sensors.radar.html">Radar</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/radar/c4dynamics.sensors.radar.radar.bias.html">c4dynamics.sensors.radar.radar.bias</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/radar/c4dynamics.sensors.radar.radar.scale_factor.html">c4dynamics.sensors.radar.radar.scale_factor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/radar/c4dynamics.sensors.radar.radar.measure.html">c4dynamics.sensors.radar.radar.measure</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/Detectors.html">Detectors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/detectors.yolov3.html">YOLOv3</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/yolov3/c4dynamics.detectors.yolo3_opencv.yolov3.nms_th.html">c4dynamics.detectors.yolo3_opencv.yolov3.nms_th</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/yolov3/c4dynamics.detectors.yolo3_opencv.yolov3.confidence_th.html">c4dynamics.detectors.yolo3_opencv.yolov3.confidence_th</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/yolov3/c4dynamics.detectors.yolo3_opencv.yolov3.detect.html">c4dynamics.detectors.yolo3_opencv.yolov3.detect</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/Filters.html">Filters</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/filters.kalman.html">Kalman filter</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/kalman/c4dynamics.filters.kalman.kalman.predict.html">c4dynamics.filters.kalman.kalman.predict</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/kalman/c4dynamics.filters.kalman.kalman.update.html">c4dynamics.filters.kalman.kalman.update</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/kalman/c4dynamics.filters.kalman.kalman.store.html">c4dynamics.filters.kalman.kalman.store</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/filters.ekf.html">Extended Kalman filter</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/ekf/c4dynamics.filters.ekf.ekf.predict.html">c4dynamics.filters.ekf.ekf.predict</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/ekf/c4dynamics.filters.ekf.ekf.update.html">c4dynamics.filters.ekf.ekf.update</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/ekf/c4dynamics.filters.ekf.ekf.store.html">c4dynamics.filters.ekf.ekf.store</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/filters.lpf.html">Lowpass filter</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/lpf/c4dynamics.filters.lowpass.lowpass.sample.html">c4dynamics.filters.lowpass.lowpass.sample</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/Routines.html">Routines</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/routines.eqm.html">Equations of motion solvers</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/eqm/c4dynamics.eqm.derivs.eqm3.html">c4dynamics.eqm.derivs.eqm3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/eqm/c4dynamics.eqm.derivs.eqm6.html">c4dynamics.eqm.derivs.eqm6</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/eqm/c4dynamics.eqm.integrate.int3.html">c4dynamics.eqm.integrate.int3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/eqm/c4dynamics.eqm.integrate.int6.html">c4dynamics.eqm.integrate.int6</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/routines.rotmat.html">Rotation matrix operations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/rotmat/c4dynamics.rotmat.rotmat.rotx.html">c4dynamics.rotmat.rotmat.rotx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/rotmat/c4dynamics.rotmat.rotmat.roty.html">c4dynamics.rotmat.rotmat.roty</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/rotmat/c4dynamics.rotmat.rotmat.rotz.html">c4dynamics.rotmat.rotmat.rotz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/rotmat/c4dynamics.rotmat.rotmat.dcm321.html">c4dynamics.rotmat.rotmat.dcm321</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/rotmat/c4dynamics.rotmat.rotmat.dcm321euler.html">c4dynamics.rotmat.rotmat.dcm321euler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/rotmat/c4dynamics.rotmat.animate.animate.html">c4dynamics.rotmat.animate.animate</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/Utils.html">Utils</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/utils/c4dynamics.utils.tictoc.tic.html">c4dynamics.utils.tictoc.tic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/utils/c4dynamics.utils.tictoc.toc.html">c4dynamics.utils.tictoc.toc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/utils/c4dynamics.utils.cprint.cprint.html">c4dynamics.utils.cprint.cprint</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/utils/c4dynamics.utils.gen_gif.gif.html">c4dynamics.utils.gen_gif.gif</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/utils/c4dynamics.utils.plottools.plotdefaults.html">c4dynamics.utils.plottools.plotdefaults</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.math.html">Math functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.const.html">Constants</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/Datasets.html">Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/datasets/c4dynamics.datasets.image.html">c4dynamics.datasets.image</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/datasets/c4dynamics.datasets.video.html">c4dynamics.datasets.video</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/datasets/c4dynamics.datasets.nn_model.html">c4dynamics.datasets.nn_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/datasets/c4dynamics.datasets.d3_model.html">c4dynamics.datasets.d3_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/datasets/c4dynamics.datasets.download_all.html">c4dynamics.datasets.download_all</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/datasets/c4dynamics.datasets.clear_cache.html">c4dynamics.datasets.clear_cache</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/programs/dof6sim.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>C4dynamics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">C4dynamics</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#6-Degrees-Of-Freedom-Example">6 Degrees Of Freedom Example</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#6dof-function">6dof function</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#DCM">DCM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Main-loop">Main loop</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p>To download this notebook use the download icon in the toolbar above and select *.ipynb</p>
<section id="C4dynamics">
<h1>C4dynamics<a class="headerlink" href="#C4dynamics" title="Link to this heading">#</a></h1>
<section id="6-Degrees-Of-Freedom-Example">
<h2>6 Degrees Of Freedom Example<a class="headerlink" href="#6-Degrees-Of-Freedom-Example" title="Link to this heading">#</a></h2>
<p>This notebook employs an example to illustrate the usage of C4dynamics to develop algorithms for missile guidance system.</p>
<p>C4dynamics is a powerful framework for algorithm engineering that enables the creation of complex simulations with six degrees of freedom (6 DOF). With its advanced toolset, it allows for the creation of realistic and dynamic models that can be used to test and analyze various scenarios in fields such as robotics, aerospace, and mechanical engineering.</p>
<p>A 6 DOF simulation on top C4dynamics provides a comprehensive platform for exploring the movement and behavior of objects in 3D space. It includes features such as real-time rendering, physics simulation, and user interaction, allowing for a highly immersive and interactive experience. The simulation is built on top of the C4dynamics framework, which provides a robust and scalable infrastructure for developing and running algorithms.</p>
<p>In this demonstration, we will showcase the power and flexibility of C4dynamics by creating a 6 DOF simulation that demonstrates its ability to accurately model complex systems and provide real-time feedback. This will include an overview of the features and tools available in C4dynamics, as well as a hands-on demonstration of how to create and run a 6 DOF simulation. Whether you are a seasoned engineer or just starting out, this demonstration will provide valuable insights into the capabilities
of the C4dynamics framework.</p>
<p>Let’s start.</p>
<p>Load third party modules</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
z:\Dropbox\c4dynamics\docs\source\programs
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;..\..\..&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">c4dynamics</span> <span class="k">as</span> <span class="nn">c4d</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<p>Load other modules that developed for the demonstration of current example</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">control_system</span><span class="p">:</span>

    <span class="n">Gn</span> <span class="o">=</span> <span class="mi">250</span> <span class="c1"># gain factor relating aoa of ctrl surface to acc cmd per unit dynamic pressure, [rad*Pa/(m/s)^2]</span>
    <span class="n">afp</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">afy</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="mf">0.04</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ab_cmd</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>
        <span class="n">afp</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Gn</span> <span class="o">*</span> <span class="n">ab_cmd</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">Q</span>
        <span class="n">afy</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">Gn</span> <span class="o">*</span> <span class="n">ab_cmd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">Q</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">afp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">afp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">)</span> <span class="o">+</span> <span class="n">afp</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">afy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">afy</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">)</span> <span class="o">+</span> <span class="n">afy</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">afp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">afp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">afp</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">afy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">afy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">afy</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">afp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">afy</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">aerodynamics</span><span class="p">():</span>
    <span class="n">mach_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.14</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">])</span>
    <span class="n">cD0_table</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.15</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="mf">0.94</span><span class="p">])</span>
    <span class="n">cLa_table</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">38</span><span class="p">,</span>  <span class="mi">39</span><span class="p">,</span>  <span class="mi">56</span><span class="p">,</span>  <span class="mi">55</span><span class="p">,</span>   <span class="mi">40</span><span class="p">,</span>   <span class="mi">33</span><span class="p">])</span>
    <span class="n">cMa_table</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">160</span><span class="p">,</span> <span class="o">-</span><span class="mi">170</span><span class="p">,</span> <span class="o">-</span><span class="mi">185</span><span class="p">,</span> <span class="o">-</span><span class="mi">235</span><span class="p">,</span> <span class="o">-</span><span class="mi">190</span><span class="p">,</span> <span class="o">-</span><span class="mi">150</span><span class="p">])</span>
    <span class="n">cMd_table</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">45</span><span class="p">])</span>
    <span class="n">cMqcMadot_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">6000</span><span class="p">,</span> <span class="o">-</span><span class="mi">13000</span><span class="p">,</span> <span class="o">-</span><span class="mi">16000</span><span class="p">,</span> <span class="o">-</span><span class="mi">13500</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">6000</span><span class="p">])</span>
    <span class="n">k_table</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0255</span><span class="p">,</span> <span class="mf">0.0305</span><span class="p">,</span> <span class="mf">0.0361</span><span class="p">,</span> <span class="mf">0.0441</span><span class="p">,</span> <span class="mf">0.0540</span><span class="p">,</span> <span class="mf">0.0665</span><span class="p">])</span>

    <span class="n">alt_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">6000</span><span class="p">])</span>
    <span class="n">pressure_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">101325</span><span class="p">,</span> <span class="mi">79501</span><span class="p">,</span> <span class="mi">61660</span><span class="p">,</span> <span class="mi">47217</span><span class="p">])</span>
    <span class="n">density_table</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.225</span><span class="p">,</span> <span class="mf">1.0066</span><span class="p">,</span> <span class="mf">0.81935</span><span class="p">,</span> <span class="mf">0.66011</span><span class="p">])</span>
    <span class="n">speed_of_sound_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">340.29</span><span class="p">,</span> <span class="mf">332.53</span><span class="p">,</span> <span class="mf">324.59</span><span class="p">,</span> <span class="mf">316.45</span><span class="p">])</span>

    <span class="n">s</span>    <span class="o">=</span> <span class="mf">0.0127</span>
    <span class="n">d</span>    <span class="o">=</span> <span class="mf">0.127</span>
    <span class="n">xref</span> <span class="o">=</span> <span class="mf">1.35</span>

    <span class="k">def</span> <span class="nf">f_coef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mach</span><span class="p">,</span> <span class="n">alpha_total</span><span class="p">):</span>
        <span class="n">cLa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">mach</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mach_table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cLa_table</span><span class="p">)</span>
        <span class="n">cD0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">mach</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mach_table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cD0_table</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">mach</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mach_table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_table</span><span class="p">)</span>

        <span class="c1"># lift and drag</span>
        <span class="n">cL</span> <span class="o">=</span> <span class="n">cLa</span> <span class="o">*</span> <span class="n">alpha_total</span>
        <span class="n">cD</span> <span class="o">=</span> <span class="n">cD0</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">cL</span><span class="o">**</span><span class="mi">2</span>

        <span class="k">return</span> <span class="n">cL</span><span class="p">,</span> <span class="n">cD</span>

    <span class="k">def</span> <span class="nf">m_coef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mach</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span>
                    <span class="p">,</span> <span class="n">d_pitch</span><span class="p">,</span> <span class="n">d_yaw</span><span class="p">,</span> <span class="n">xcm</span>
                    <span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">fAby</span><span class="p">,</span> <span class="n">fAbz</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="n">cNb</span> <span class="o">=</span> <span class="n">cMa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">mach</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mach_table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cMa_table</span><span class="p">)</span>
        <span class="n">cNd</span> <span class="o">=</span> <span class="n">cMd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">mach</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mach_table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cMd_table</span><span class="p">)</span>
        <span class="n">cNrcNbdot</span> <span class="o">=</span> <span class="n">cMqcMadot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">mach</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mach_table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cMqcMadot_table</span><span class="p">)</span>

        <span class="c1"># pitch and yaw moments</span>
        <span class="c1"># yb, zb normal force aero coefficient</span>
        <span class="n">cNy</span> <span class="o">=</span> <span class="n">fAby</span> <span class="o">/</span> <span class="n">Q</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
        <span class="n">cNz</span> <span class="o">=</span> <span class="n">fAbz</span> <span class="o">/</span> <span class="n">Q</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
        <span class="n">cMref</span> <span class="o">=</span> <span class="n">cMa</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">cMd</span> <span class="o">*</span> <span class="n">d_pitch</span>
        <span class="n">cNref</span> <span class="o">=</span> <span class="n">cNb</span> <span class="o">*</span> <span class="n">beta</span>  <span class="o">+</span> <span class="n">cNd</span> <span class="o">*</span> <span class="n">d_yaw</span>

        <span class="c1"># to center of mass</span>
        <span class="n">cM</span> <span class="o">=</span> <span class="n">cMref</span> <span class="o">-</span> <span class="n">cNz</span> <span class="o">*</span> <span class="p">(</span><span class="n">xcm</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xref</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">cMqcMadot</span> <span class="o">*</span> <span class="n">q</span>
        <span class="n">cN</span> <span class="o">=</span> <span class="n">cNref</span> <span class="o">-</span> <span class="n">cNy</span> <span class="o">*</span> <span class="p">(</span><span class="n">xcm</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xref</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">cNrcNbdot</span> <span class="o">*</span> <span class="n">r</span>

        <span class="k">return</span> <span class="n">cM</span><span class="p">,</span> <span class="n">cN</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">m2idx</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">aerodynamics</span><span class="o">.</span><span class="n">mach_table</span> <span class="o">-</span> <span class="n">m</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">alt2atmo</span><span class="p">(</span><span class="n">alt</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">alt</span><span class="p">,</span> <span class="n">aerodynamics</span><span class="o">.</span><span class="n">alt_table</span><span class="p">,</span> <span class="n">aerodynamics</span><span class="o">.</span><span class="n">pressure_table</span><span class="p">)</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">alt</span><span class="p">,</span> <span class="n">aerodynamics</span><span class="o">.</span><span class="n">alt_table</span><span class="p">,</span> <span class="n">aerodynamics</span><span class="o">.</span><span class="n">density_table</span><span class="p">)</span>
        <span class="n">vs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">alt</span><span class="p">,</span> <span class="n">aerodynamics</span><span class="o">.</span><span class="n">alt_table</span><span class="p">,</span> <span class="n">aerodynamics</span><span class="o">.</span><span class="n">speed_of_sound_table</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">vs</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">engine</span><span class="p">():</span>
    <span class="c1"># sec</span>
    <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="mf">.04</span><span class="p">,</span> <span class="mf">.05</span><span class="p">,</span> <span class="mf">.08</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mf">.2</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">3.8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">4.3</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">,</span> <span class="mf">4.9</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">,</span> <span class="mf">5.6</span><span class="p">])</span>
    <span class="c1"># Newton</span>
    <span class="n">thrust</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="mi">17800</span><span class="p">,</span> <span class="mi">23100</span><span class="p">,</span> <span class="mi">21300</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="mi">18200</span><span class="p">,</span> <span class="mi">17000</span><span class="p">,</span> <span class="mi">15000</span><span class="p">,</span> <span class="mi">13800</span><span class="p">,</span> <span class="mi">13300</span><span class="p">,</span> <span class="mi">13800</span><span class="p">,</span> <span class="mi">14700</span><span class="p">,</span> <span class="mi">14300</span><span class="p">,</span> <span class="mi">12900</span><span class="p">,</span> <span class="mi">11000</span><span class="p">,</span> <span class="mi">7000</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">2900</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="c1"># tbo = 5.6       # t burnout</span>
    <span class="n">pref</span> <span class="o">=</span> <span class="mi">101314</span>   <span class="c1"># reference ambient pressure</span>
    <span class="n">Ae</span> <span class="o">=</span> <span class="mf">.011</span>       <span class="c1"># exit area of rocket nozzle</span>
    <span class="n">Isp</span> <span class="o">=</span> <span class="mi">2224</span>      <span class="c1"># specific impulse</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">pa</span><span class="p">):</span>
        <span class="c1"># return thrust force at time t and pressure pa</span>
        <span class="c1"># pa pressure at altitude h</span>
        <span class="n">thrust_ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">thrust</span><span class="p">)</span> <span class="c1"># thrust at time t</span>
        <span class="n">thrust_atm</span> <span class="o">=</span> <span class="n">thrust_ref</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pref</span> <span class="o">-</span> <span class="n">pa</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ae</span> <span class="c1"># correction for atmosphere conditions</span>
        <span class="k">return</span> <span class="n">thrust_atm</span><span class="p">,</span> <span class="n">thrust_ref</span>
</pre></div>
</div>
</div>
<p>Configure figure properties</p>
<p>Simulation setup</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="mf">5e-3</span>
<span class="n">vm</span> <span class="o">=</span> <span class="mi">30</span>
</pre></div>
</div>
</div>
<p>Objects definition</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target</span> <span class="o">=</span> <span class="n">c4d</span><span class="o">.</span><span class="n">datapoint</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">4000</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3000</span><span class="p">,</span> <span class="n">vx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vz</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The target is a datapoint object which means it has all the attributes of a mass in space: Position: target.x, target.y, target.z Velocity: target.vx, target.vy, target.vz Acceleration: target.ax, target.ay, target.az It also has mass: target.m (necessary for solving the equations of motion in the case of accelerating motion)</p>
<p>The target object in the example is initialized with initial position conditions in 3 axes and velocity conditions in the x-axis only. Acceleration is not initialized which is equivalent to zero initialization (default). As the target in the example is non-accelerating it is not necessary to provide the mass with its instantiation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missile</span> <span class="o">=</span> <span class="n">c4d</span><span class="o">.</span><span class="n">rigidbody</span><span class="p">()</span>
<span class="n">missile</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mi">85</span>
<span class="n">missile</span><span class="o">.</span><span class="n">I</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">61</span><span class="p">]</span>
<span class="n">missile</span><span class="o">.</span><span class="n">xcm</span> <span class="o">=</span> <span class="mf">1.55</span>

<span class="n">m0</span>      <span class="o">=</span> <span class="n">missile</span><span class="o">.</span><span class="n">mass</span>
<span class="n">xcm0</span>    <span class="o">=</span> <span class="n">missile</span><span class="o">.</span><span class="n">xcm</span>
<span class="n">i0</span>      <span class="o">=</span> <span class="n">missile</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>The missile is a rigid-body object which means that it has all the attributes of a datapoint but in addition: Body angles: missile.phi, missile.theta, missile.psi (Euler) Angular rates: missile.p, missile.q, missile.r (rotation about x-body, y-body, and z-body, respectively) Angular accelerations: missile.p_dot, missile.q_dot, missile.r_dot (about x-body, y-body, and z-body, respectively)</p>
<p>As a rigid-body object it has also inertia attributes (necessary for solving the equations of motion in the case of accelerating motion): Moment of inertia: missile.ixx, missile.iyy, missile.izz (about x-body, y-body, and z-body, respectively) Distance from nose to center of mass: missile.xcm</p>
<p>The missile kinematic attributes in this example have not initialized with any initial conditions which mean that all its attributes are zero. But the mass properties provided as necessary. However, we will immediately see that the missile has initial kinematic conditions which are loaded through direct assignment and not by the class constructor (c4d.rigidbody()).</p>
<p>As the dynamics in this example involves a combustion of fuel of the rocket engine the missile’s mass attributes varying as function of time. To recalculate the mass during the run time it’s a good advice to save these initial conditions. As iyy and izz are equal here it’s enough to save just one of them. In any way the initial position and attitude of anybody object (datapoint and rigid-body) is always saved with its instantiation</p>
<p>The dimensions in this example are SI (i.e. seconds, meters, kilograms), but the objects and functions in the framework in general are independent of system of units.</p>
<p>The example uses a line-of-sight seeker object from the c4dynamics’ sensors module and controller, engine, and aerodynamics objects that developed for the purpose of this example:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seeker</span>  <span class="o">=</span> <span class="n">c4d</span><span class="o">.</span><span class="n">sensors</span><span class="o">.</span><span class="n">lineofsight</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">tau1</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">tau2</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">ctrl</span>    <span class="o">=</span> <span class="n">control_system</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
<span class="n">eng</span>     <span class="o">=</span> <span class="n">engine</span><span class="p">()</span>
<span class="n">aero</span>    <span class="o">=</span> <span class="n">aerodynamics</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39; run script &#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">c4dynamics</span> <span class="kn">import</span> <span class="n">c4dir</span>
<span class="n">c4path</span> <span class="o">=</span> <span class="n">c4dir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>

<span class="c1"># user input</span>
<span class="n">outfol</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c4path</span><span class="p">,</span> <span class="s1">&#39;docs&#39;</span><span class="p">,</span> <span class="s1">&#39;source&#39;</span><span class="p">,</span> <span class="s1">&#39;programs&#39;</span><span class="p">,</span> <span class="s1">&#39;figures&#39;</span><span class="p">,</span> <span class="s1">&#39;dof6sim&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="6dof-function">
<h1>6dof function<a class="headerlink" href="#6dof-function" title="Link to this heading">#</a></h1>
<section id="Setup">
<h2>Setup<a class="headerlink" href="#Setup" title="Link to this heading">#</a></h2>
<p>The initial missile pointing direction and angular rates are calculated in the fire-control block. For the example simulation, a simple algorithm is employed in which the missile is pointed directly at the target at the instant of launch, and missile angular rates at launch are assumed to be negligible.</p>
<p>The unit vector in the direction from the missile to the target is calculated by normalizing the range vector.</p>
</section>
<section id="DCM">
<h2>DCM<a class="headerlink" href="#DCM" title="Link to this heading">#</a></h2>
<p>The function missile.BR is bounded method of the rigid-body class. The function generates a Body from Inertial DCM (Direction Cosine Matrix) matrix in 3-2-1 order. Using this matrix, the missile velocity vector in the inertial frame of coordinates is rotated to represent the velocity in the body frame of coordinates.</p>
<p>The inertial frame is determined by the frame that the initial Euler angles refer to. In this example the Euler angles are with respect the x parallel to flat earth in the direction of the missile centerline, z positive downward, and y such that z completes a right-hand system.</p>
<p>The velocity vector is also produced by a bounded method of the class. The methods datapoint.positionition, datapoint.velocity, datapoint.acc read the current state of the object and return a three entries array composed of the coordinates of position, velocity, and acceleration, respectively.</p>
<p>Similarly, the properties datapoint.P(), datapoint.V() return the object squared norm of the position, velocity, and acceleration, respectively.</p>
</section>
<section id="Main-loop">
<h2>Main loop<a class="headerlink" href="#Main-loop" title="Link to this heading">#</a></h2>
<p>The main loop includes the following steps:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Estimation of missile-target line-of-sight angular rate
Production of missile&#39;s wings-deflection commands
Calculation of missile&#39;s forces and moments
Integration of missile&#39;s equations of motion
Integration of target&#39;s equations of motion
Simulation update
</pre></div>
</div>
<p>The simulation runs until one of the following conditions: The missile hits the ground The simulation time is over</p>
<p>Comments are introduced inline.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define objects</span>
<span class="n">missile</span> <span class="o">=</span> <span class="n">c4d</span><span class="o">.</span><span class="n">rigidbody</span><span class="p">()</span>
<span class="n">target</span>  <span class="o">=</span> <span class="n">c4d</span><span class="o">.</span><span class="n">datapoint</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">4000</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3000</span><span class="p">,</span> <span class="n">vx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vz</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">seeker</span> <span class="o">=</span> <span class="n">c4d</span><span class="o">.</span><span class="n">sensors</span><span class="o">.</span><span class="n">lineofsight</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">tau1</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">tau2</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">isideal</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">ctrl</span>   <span class="o">=</span> <span class="n">control_system</span><span class="p">(</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">eng</span>    <span class="o">=</span> <span class="n">engine</span><span class="p">()</span>
<span class="n">aero</span>   <span class="o">=</span> <span class="n">aerodynamics</span><span class="p">()</span>

<span class="n">missile</span><span class="o">.</span><span class="n">mass</span>   <span class="o">=</span> <span class="n">m0</span>   <span class="o">=</span> <span class="mi">85</span>         <span class="c1"># initial mass, kg</span>
<span class="n">mbo</span>         <span class="o">=</span> <span class="mi">57</span>                <span class="c1"># burnout mass, kg</span>
<span class="n">missile</span><span class="o">.</span><span class="n">xcm</span> <span class="o">=</span> <span class="n">xcm0</span> <span class="o">=</span> <span class="mf">1.55</span>       <span class="c1"># nose to center of mass length, m</span>
<span class="n">xcmbo</span>       <span class="o">=</span> <span class="mf">1.35</span>              <span class="c1"># nose to cm after burnout, m</span>
<span class="n">missile</span><span class="o">.</span><span class="n">iyy</span> <span class="o">=</span> <span class="n">missile</span><span class="o">.</span><span class="n">izz</span> <span class="o">=</span> <span class="n">i0</span> <span class="o">=</span> <span class="mi">61</span>
<span class="n">ibo</span>         <span class="o">=</span> <span class="mi">47</span>                <span class="c1"># iyy izz at burnout</span>

<span class="c1"># init</span>
<span class="c1"># The initial missile direction and angular rates are calculated in the fire-control block.</span>
<span class="c1"># For the example simulation, a simple algorithm is employed in which the missile is</span>
<span class="c1"># pointed directly at the target at the instant of launch, and missile angular rates at launch are assumed to be negligible.</span>
<span class="c1"># The unit vector uR in the direction from the missile to the target is calculated by normalizing the range vector R.</span>
<span class="c1">##</span>
<span class="n">rTM</span>           <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">position</span> <span class="o">-</span> <span class="n">missile</span><span class="o">.</span><span class="n">position</span>
<span class="n">rTMnorm</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">rTM</span><span class="p">)</span>
<span class="n">ucl</span>           <span class="o">=</span> <span class="n">rTM</span> <span class="o">/</span> <span class="n">rTMnorm</span> <span class="c1"># center line unit vector</span>
<span class="n">missile</span><span class="o">.</span><span class="n">vx</span><span class="p">,</span> <span class="n">missile</span><span class="o">.</span><span class="n">vy</span><span class="p">,</span> <span class="n">missile</span><span class="o">.</span><span class="n">vz</span> <span class="o">=</span> <span class="n">vm</span> <span class="o">*</span> <span class="n">ucl</span>
<span class="n">missile</span><span class="o">.</span><span class="n">psi</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">ucl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">ucl</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">missile</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="o">-</span><span class="n">ucl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ucl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ucl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">missile</span><span class="o">.</span><span class="n">phi</span>   <span class="o">=</span> <span class="mi">0</span>
<span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span>       <span class="o">=</span> <span class="n">missile</span><span class="o">.</span><span class="n">BR</span> <span class="o">@</span> <span class="n">missile</span><span class="o">.</span><span class="n">velocity</span>
<span class="n">vc</span>            <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="c1"># these copy of md calc actually didnt change a bit in the results</span>
<span class="c1"># bf = True # before flyby</span>
<span class="c1"># rr = False # negative range rate flag</span>

<span class="n">alpha</span>       <span class="o">=</span> <span class="mi">0</span>
<span class="n">beta</span>        <span class="o">=</span> <span class="mi">0</span>
<span class="n">alpha_total</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># alpha_total_data = alpha_total</span>
<span class="c1"># prp_data = np.array([0, 0])</span>

<span class="c1"># h = missile.z   # missile altitude above sea level, m</span>
<span class="n">d_pitch</span>  <span class="o">=</span> <span class="mi">0</span>
<span class="n">d_yaw</span>    <span class="o">=</span> <span class="mi">0</span>

<span class="n">ab_cmd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">delta_data</span>   <span class="o">=</span> <span class="p">[]</span>
<span class="n">omegaf_data</span>  <span class="o">=</span> <span class="p">[]</span>
<span class="n">acc_data</span>     <span class="o">=</span> <span class="p">[]</span>
<span class="n">aoa_data</span>     <span class="o">=</span> <span class="p">[]</span>
<span class="n">moments_data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">t</span>  <span class="o">=</span> <span class="mi">0</span>
<span class="n">tf</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># 10 # 60</span>

<span class="n">h</span> <span class="o">=</span> <span class="o">-</span><span class="n">missile</span><span class="o">.</span><span class="n">z</span> <span class="c1"># missile altitude above sea level</span>

<span class="k">while</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">tf</span> <span class="ow">and</span> <span class="n">h</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">vc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># bf:</span>
    <span class="c1"># atmospheric calculations</span>
    <span class="n">pressure</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">vs</span> <span class="o">=</span> <span class="n">aerodynamics</span><span class="o">.</span><span class="n">alt2atmo</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

    <span class="n">mach</span> <span class="o">=</span> <span class="n">missile</span><span class="o">.</span><span class="n">V</span><span class="p">()</span> <span class="o">/</span> <span class="n">vs</span> <span class="c1"># mach number</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">missile</span><span class="o">.</span><span class="n">V</span><span class="p">()</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># dynamic pressure</span>

    <span class="c1"># relative position</span>
    <span class="n">vTM</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">velocity</span> <span class="o">-</span> <span class="n">missile</span><span class="o">.</span><span class="n">velocity</span> <span class="c1"># missile-target relative velocity</span>
    <span class="n">rTM</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">position</span> <span class="o">-</span> <span class="n">missile</span><span class="o">.</span><span class="n">position</span> <span class="c1"># relative position</span>

    <span class="c1"># relative velcoity</span>
    <span class="n">rTMnorm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">rTM</span><span class="p">)</span> <span class="c1"># for next round</span>
    <span class="n">uR</span>     <span class="o">=</span> <span class="n">rTM</span> <span class="o">/</span> <span class="n">rTMnorm</span> <span class="c1"># unit range vector</span>
    <span class="n">vc</span>     <span class="o">=</span> <span class="o">-</span><span class="n">uR</span> <span class="o">*</span> <span class="n">vTM</span> <span class="c1"># closing velocity</span>

    <span class="c1"># seeker</span>
    <span class="n">wf</span> <span class="o">=</span> <span class="n">seeker</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">rTM</span><span class="p">,</span> <span class="n">vTM</span><span class="p">)</span> <span class="c1"># filtered los vector</span>
    <span class="n">omegaf_data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">wf</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wf</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>

    <span class="c1"># guidance and control</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">:</span>
        <span class="n">Gs</span>       <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">missile</span><span class="o">.</span><span class="n">V</span><span class="p">()</span>
        <span class="n">acmd</span>     <span class="o">=</span> <span class="n">Gs</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">wf</span><span class="p">,</span> <span class="n">ucl</span><span class="p">)</span>
        <span class="n">ab_cmd</span>   <span class="o">=</span> <span class="n">missile</span><span class="o">.</span><span class="n">BR</span> <span class="o">@</span> <span class="n">acmd</span>
        <span class="n">afp</span><span class="p">,</span> <span class="n">afy</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ab_cmd</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
        <span class="n">d_pitch</span>  <span class="o">=</span> <span class="n">afp</span> <span class="o">-</span> <span class="n">alpha</span>
        <span class="n">d_yaw</span>    <span class="o">=</span> <span class="n">afy</span> <span class="o">-</span> <span class="n">beta</span>

    <span class="n">acc_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ab_cmd</span><span class="p">)</span>
    <span class="n">delta_data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">d_pitch</span><span class="p">,</span> <span class="n">d_yaw</span><span class="p">])</span>

    <span class="c1"># missile dynamics</span>
    <span class="c1"># aerodynamics forces</span>
    <span class="n">cL</span><span class="p">,</span> <span class="n">cD</span> <span class="o">=</span> <span class="n">aero</span><span class="o">.</span><span class="n">f_coef</span><span class="p">(</span><span class="n">mach</span><span class="p">,</span> <span class="n">alpha_total</span><span class="p">)</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">*</span> <span class="n">aero</span><span class="o">.</span><span class="n">s</span> <span class="o">*</span> <span class="n">cL</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">*</span> <span class="n">aero</span><span class="o">.</span><span class="n">s</span> <span class="o">*</span> <span class="n">cD</span>

    <span class="n">A</span> <span class="o">=</span> <span class="n">D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha_total</span><span class="p">)</span> <span class="o">-</span> <span class="n">L</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha_total</span><span class="p">)</span> <span class="c1"># aero axial force</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha_total</span><span class="p">)</span> <span class="o">+</span> <span class="n">L</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha_total</span><span class="p">)</span> <span class="c1"># aero normal force</span>

    <span class="n">fAb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="n">A</span>
                    <span class="p">,</span> <span class="n">N</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">v</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
                    <span class="p">,</span> <span class="n">N</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">))])</span>
    <span class="n">fAe</span> <span class="o">=</span> <span class="n">missile</span><span class="o">.</span><span class="n">RB</span> <span class="o">@</span> <span class="n">fAb</span>

    <span class="c1"># aerodynamics moments</span>
    <span class="n">cM</span><span class="p">,</span> <span class="n">cN</span> <span class="o">=</span> <span class="n">aero</span><span class="o">.</span><span class="n">m_coef</span><span class="p">(</span><span class="n">mach</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">d_pitch</span><span class="p">,</span> <span class="n">d_yaw</span>
                        <span class="p">,</span> <span class="n">missile</span><span class="o">.</span><span class="n">xcm</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">missile</span><span class="o">.</span><span class="n">V</span><span class="p">(),</span> <span class="n">fAb</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fAb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                            <span class="p">,</span> <span class="n">missile</span><span class="o">.</span><span class="n">q</span><span class="p">,</span> <span class="n">missile</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>

    <span class="n">mA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span>                     <span class="c1"># aerodynamic moemnt in roll</span>
                <span class="p">,</span> <span class="n">Q</span> <span class="o">*</span> <span class="n">cM</span> <span class="o">*</span> <span class="n">aero</span><span class="o">.</span><span class="n">s</span> <span class="o">*</span> <span class="n">aero</span><span class="o">.</span><span class="n">d</span>         <span class="c1"># aerodynamic moment in pitch</span>
                <span class="p">,</span> <span class="n">Q</span> <span class="o">*</span> <span class="n">cN</span> <span class="o">*</span> <span class="n">aero</span><span class="o">.</span><span class="n">s</span> <span class="o">*</span> <span class="n">aero</span><span class="o">.</span><span class="n">d</span><span class="p">])</span>       <span class="c1"># aerodynamic moment in yaw</span>

    <span class="n">moments_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mA</span><span class="p">)</span>
    <span class="c1"># propulsion</span>
    <span class="n">thrust</span><span class="p">,</span> <span class="n">thref</span> <span class="o">=</span> <span class="n">eng</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">pressure</span><span class="p">)</span>
    <span class="n">fPb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">thrust</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="n">fPe</span> <span class="o">=</span> <span class="n">missile</span><span class="o">.</span><span class="n">RB</span> <span class="o">@</span> <span class="n">fPb</span>

    <span class="c1"># gravity</span>
    <span class="n">fGe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">missile</span><span class="o">.</span><span class="n">mass</span> <span class="o">*</span> <span class="n">c4d</span><span class="o">.</span><span class="n">g_ms2</span><span class="p">])</span>

    <span class="c1"># total forces</span>
    <span class="n">forces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fAe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">fPe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">fGe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="p">,</span> <span class="n">fAe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">fPe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">fGe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                            <span class="p">,</span> <span class="n">fAe</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">fPe</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">fGe</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>

    <span class="c1"># missile motion integration</span>
    <span class="n">missile</span><span class="o">.</span><span class="n">inteqm</span><span class="p">(</span><span class="n">forces</span><span class="p">,</span> <span class="n">mA</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

    <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">missile</span><span class="o">.</span><span class="n">BR</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">missile</span><span class="o">.</span><span class="n">vx</span><span class="p">,</span> <span class="n">missile</span><span class="o">.</span><span class="n">vy</span><span class="p">,</span> <span class="n">missile</span><span class="o">.</span><span class="n">vz</span><span class="p">])</span>

    <span class="c1"># target dynmaics</span>
    <span class="n">target</span><span class="o">.</span><span class="n">inteqm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">dt</span><span class="p">)</span>

    <span class="c1"># update</span>
    <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
    <span class="n">missile</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">target</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="n">missile</span><span class="o">.</span><span class="n">mass</span> <span class="o">-=</span> <span class="n">thref</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">eng</span><span class="o">.</span><span class="n">Isp</span>
    <span class="n">missile</span><span class="o">.</span><span class="n">xcm</span>   <span class="o">=</span> <span class="n">xcm0</span> <span class="o">-</span> <span class="p">(</span><span class="n">xcm0</span> <span class="o">-</span> <span class="n">xcmbo</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">m0</span> <span class="o">-</span> <span class="n">missile</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">m0</span> <span class="o">-</span> <span class="n">mbo</span><span class="p">)</span>
    <span class="n">izz</span> <span class="o">=</span> <span class="n">iyy</span> <span class="o">=</span> <span class="n">i0</span> <span class="o">-</span> <span class="p">(</span><span class="n">i0</span> <span class="o">-</span> <span class="n">ibo</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">m0</span> <span class="o">-</span> <span class="n">missile</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">m0</span> <span class="o">-</span> <span class="n">mbo</span><span class="p">)</span>

    <span class="n">missile</span><span class="o">.</span><span class="n">I</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">iyy</span><span class="p">,</span> <span class="n">izz</span><span class="p">]</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
    <span class="n">beta</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">-</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>

    <span class="n">uvm</span> <span class="o">=</span> <span class="n">missile</span><span class="o">.</span><span class="n">velocity</span> <span class="o">/</span> <span class="n">missile</span><span class="o">.</span><span class="n">V</span><span class="p">()</span>
    <span class="n">ucl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">psi</span><span class="p">)</span>
                    <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">psi</span><span class="p">)</span>
                    <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">missile</span><span class="o">.</span><span class="n">theta</span><span class="p">)])</span>
    <span class="n">alpha_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">uvm</span> <span class="o">@</span> <span class="n">ucl</span><span class="p">)</span>
    <span class="n">aoa_data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">alpha_total</span><span class="p">])</span>

    <span class="n">h</span> <span class="o">=</span> <span class="o">-</span><span class="n">missile</span><span class="o">.</span><span class="n">z</span>

<span class="n">vTM</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">velocity</span> <span class="o">-</span> <span class="n">missile</span><span class="o">.</span><span class="n">velocity</span> <span class="c1"># missile-target relative velocity</span>
<span class="n">uvTM</span> <span class="o">=</span> <span class="n">vTM</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vTM</span><span class="p">)</span>

<span class="n">rTM</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">position</span> <span class="o">-</span> <span class="n">missile</span><span class="o">.</span><span class="n">position</span> <span class="c1"># relative position</span>

<span class="n">md</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">rTM</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rTM</span><span class="p">,</span> <span class="n">uvTM</span><span class="p">)</span> <span class="o">*</span> <span class="n">uvTM</span><span class="p">)</span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rTM</span><span class="p">,</span> <span class="n">uvTM</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vTM</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;miss: </span><span class="si">%.5f</span><span class="s1">, flight time: </span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">tfinal</span><span class="p">))</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
miss: 0.08910, flight time: 7.4
</pre></div></div>
</div>
<p>The missile.run() function and the target.run() function perform integration of the equations of motion. The integration is performed by running Runge-Kutta of fourth order. For a datapoint, the equations are composed of translational equations, while for a datapoint they also include the rotational equations.</p>
<p>Therefore, for a datapoint object, like the target in this example, a force vector is necessary for the evaluation of the derivatives. The force must be given in the inertial frame of reference. As the target in this example is not maneuvering, the force vector is [0, 0, 0].</p>
<p>For a rigid-body object, like the missile in this example, a force vector and moment vector are necessary for the evaluation of the derivatives. The force vector must be given in the inertial frame of reference. Therefore, the propulsion, and the aerodynamic forces are rotated to the inertial frame using the DCM321 missile.RB() function. The gravity forces are already given in the inertial frame and therefore remain intact.</p>
<p>Forces and moments in the inertial frame are introduced to provide an estimation of the derivatives that represent the equations of motion. The integration method, 4th order Runge-Kutta is performed manually and independent on any third-party framework (such as scipy), therefore, currently, they may be non-optimal in terms of step-size variation. The choice of this is due to a feature which this framework desires to satisfy in which derivatives of two objects (such as missile and target) could
be integrated simultaneously, with reciprocal dependent.</p>
<p>Hopefully, later the function will be also optimized in terms of run-time and step-size variation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">textcolor</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;missile&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">target</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;target&#39;</span><span class="p">)</span>
<span class="c1"># ax1.set_title(&#39;Side View&#39;, color = textcolor)</span>
<span class="c1"># ax1.set(xlabel = &#39;Downrange (km)&#39;, ylabel = &#39;Altitude (km)&#39;)</span>
<span class="c1"># ax1.xaxis.label.set_color(textcolor)</span>
<span class="c1"># ax1.yaxis.label.set_color(textcolor)</span>
<span class="c1"># ax1.set_xlim(0, 5)</span>
<span class="c1"># ax1.set_ylim(0, 3.5)</span>
<span class="c1"># ax1.grid(alpha = .5,  which = &#39;both&#39;, color = textcolor)</span>
<span class="c1"># ax1.tick_params(axis = &#39;x&#39;, colors = textcolor)  # Change X-axis tick color to purple</span>
<span class="c1"># ax1.tick_params(axis = &#39;y&#39;, colors = textcolor)  # Change X-axis tick color to purple</span>
<span class="c1"># ax1.legend(fontsize = 14) # title = &#39;#trk&#39;, loc = &#39;center left&#39;, bbox_to_anchor = (1, 0.5))</span>
<span class="n">c4d</span><span class="o">.</span><span class="n">plotdefaults</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="s1">&#39;Side View&#39;</span><span class="p">,</span> <span class="s1">&#39;Downrange (km)&#39;</span><span class="p">,</span> <span class="s1">&#39;Altitude (km)&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;missile&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">target</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;target&#39;</span><span class="p">)</span>
<span class="c1"># ax2.set_title(&#39;Top View&#39;, color = textcolor)</span>
<span class="c1"># ax2.set(xlabel = &#39;Downrange (km)&#39;, ylabel = &#39;Crossrange (km)&#39;)</span>
<span class="c1"># ax2.xaxis.label.set_color(textcolor)</span>
<span class="c1"># ax2.yaxis.label.set_color(textcolor)</span>
<span class="c1"># ax2.set_xlim(0, 5)</span>
<span class="c1"># ax2.set_ylim(0, 1.5)</span>
<span class="c1"># ax2.grid(alpha = .5, which = &#39;both&#39;, color = textcolor)</span>
<span class="c1"># ax2.tick_params(axis = &#39;x&#39;, colors = textcolor)  # Change X-axis tick color to purple</span>
<span class="c1"># ax2.tick_params(axis = &#39;y&#39;, colors = textcolor)  # Change X-axis tick color to purple</span>
<span class="c1"># ax2.legend(fontsize = 14) # title = &#39;#trk&#39;, loc = &#39;center left&#39;, bbox_to_anchor=(1, 0.5))</span>
<span class="c1"># # ax2.invert_yaxis()</span>
<span class="c1"># plt.subplots_adjust(hspace = 1)</span>
<span class="c1"># plt.savefig(os.path.join(outfol, &#39;dof6sim_topside.png&#39;), format = &#39;png&#39;, transparent = True)</span>
<span class="n">c4d</span><span class="o">.</span><span class="n">plotdefaults</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="s1">&#39;Top View&#39;</span><span class="p">,</span> <span class="s1">&#39;Downrange (km)&#39;</span><span class="p">,</span> <span class="s1">&#39;Crossrange (km)&#39;</span><span class="p">)</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/programs_dof6sim_26_0.png" src="../_images/programs_dof6sim_26_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wfig</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">hfig</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">dfig</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">wfig</span><span class="p">,</span> <span class="n">hfig</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span> <span class="o">=</span> <span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="c1"># Plot the trajectory</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="mf">0.3048</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;missile&#39;</span><span class="p">)</span> <span class="c1"># , color = &#39;#2ECC71&#39;) # &#39;#001F3F&#39;) # )</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>  <span class="n">target</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>  <span class="n">target</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="mf">0.3048</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;target&#39;</span><span class="p">)</span> <span class="c1"># , color = &#39;#E74C3C&#39;) # &#39;#FF5733&#39;) # )</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Trajectories&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;X (m)&#39;</span><span class="p">,</span> <span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;Y (m)&#39;</span><span class="p">,</span> <span class="n">zlabel</span> <span class="o">=</span> <span class="s1">&#39;Z (ft)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_zaxis</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_box_aspect</span><span class="p">([</span><span class="n">wfig</span><span class="p">,</span> <span class="n">hfig</span><span class="p">,</span> <span class="n">dfig</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span> <span class="c1"># title = &#39;#trk&#39;, loc = &#39;center left&#39;, bbox_to_anchor = (1, 0.5))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">ax</span><span class="o">.</span><span class="n">zaxis</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1"># ax.grid(alpha = .1)</span>
<span class="c1"># Show the plot</span>
<span class="c1"># fig.set_size_inches(w, h)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">_axinfo</span><span class="p">[</span><span class="s2">&quot;grid&quot;</span><span class="p">][</span><span class="s1">&#39;linestyle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">_axinfo</span><span class="p">[</span><span class="s2">&quot;grid&quot;</span><span class="p">][</span><span class="s1">&#39;linestyle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">zaxis</span><span class="o">.</span><span class="n">_axinfo</span><span class="p">[</span><span class="s2">&quot;grid&quot;</span><span class="p">][</span><span class="s1">&#39;linestyle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span>
<span class="c1"># # plt.savefig(os.path.join(outfol, &#39;dof6sim_trajectories.png&#39;), dpi = 72)</span>

<span class="c1"># # plt.show()</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/programs_dof6sim_27_0.png" src="../_images/programs_dof6sim_27_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># omega los</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># fig.tight_layout()</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">omegaf_data</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">c4d</span><span class="o">.</span><span class="n">r2d</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">)</span>
<span class="c1"># ax1.set_title(&#39;$omega_p$&#39;)</span>
<span class="c1"># ax1.grid()</span>
<span class="c1"># ax1.set_xlim(0, 10)</span>
<span class="c1"># ax1.set_ylim(-10, 10)</span>
<span class="c1"># ax1.set(xlabel = &#39;time&#39;, ylabel = &#39;&#39;)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">omegaf_data</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">c4d</span><span class="o">.</span><span class="n">r2d</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">)</span>
<span class="c1"># ax2.set_title(&#39;$omega_y$&#39;)</span>
<span class="c1"># ax2.grid()</span>
<span class="c1"># ax2.set_xlim(0, 10)</span>
<span class="c1"># ax2.set_ylim(-10, 10)</span>
<span class="c1"># ax2.set(xlabel = &#39;time&#39;, ylabel = &#39;&#39;)</span>

<span class="c1"># plt.subplots_adjust(hspace = 0.5)</span>

<span class="n">c4d</span><span class="o">.</span><span class="n">plotdefaults</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="s1">&#39;$\omega_p$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">c4d</span><span class="o">.</span><span class="n">plotdefaults</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="s1">&#39;$\omega_y$&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/programs_dof6sim_28_0.png" src="../_images/programs_dof6sim_28_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># wing deflctions</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">delta_data</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">c4d</span><span class="o">.</span><span class="n">r2d</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">)</span>
<span class="c1"># ax1.set_title(&#39;\delta p&#39;)</span>
<span class="c1"># ax1.grid()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">delta_data</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">c4d</span><span class="o">.</span><span class="n">r2d</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">)</span>
<span class="c1"># ax2.set_title(&#39;\delta y&#39;)</span>
<span class="c1"># ax2.grid()</span>
<span class="n">c4d</span><span class="o">.</span><span class="n">plotdefaults</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="s1">&#39;$\delta_p$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">c4d</span><span class="o">.</span><span class="n">plotdefaults</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="s1">&#39;$\delta_y$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/programs_dof6sim_29_0.png" src="../_images/programs_dof6sim_29_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># body-frame acceleration cmds</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">acc_data</span><span class="p">)[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">c4d</span><span class="o">.</span><span class="n">g_ms2</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">)</span>
<span class="c1"># ax1.set_title(&#39;aczb&#39;)</span>
<span class="c1"># ax1.grid()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">acc_data</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">c4d</span><span class="o">.</span><span class="n">g_ms2</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">)</span>
<span class="c1"># ax2.set_title(&#39;acyb&#39;)</span>
<span class="c1"># ax2.grid()</span>
<span class="n">c4d</span><span class="o">.</span><span class="n">plotdefaults</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="s1">&#39;a_c_z_b&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">c4d</span><span class="o">.</span><span class="n">plotdefaults</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="s1">&#39;a_c_y_b&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/programs_dof6sim_30_0.png" src="../_images/programs_dof6sim_30_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># angles of attack</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">aoa_data</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">c4d</span><span class="o">.</span><span class="n">r2d</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">)</span>
<span class="c1"># ax1.set_title(&#39;alpha&#39;)</span>
<span class="c1"># ax1.grid()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">aoa_data</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">c4d</span><span class="o">.</span><span class="n">r2d</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">)</span>
<span class="c1"># ax2.set_title(&#39;beta&#39;)</span>
<span class="c1"># ax2.grid()</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">aoa_data</span><span class="p">)[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">c4d</span><span class="o">.</span><span class="n">r2d</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">)</span>
<span class="c1"># ax3.set_title(&#39;total&#39;)</span>
<span class="c1"># ax3.grid()</span>
<span class="n">c4d</span><span class="o">.</span><span class="n">plotdefaults</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">c4d</span><span class="o">.</span><span class="n">plotdefaults</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">c4d</span><span class="o">.</span><span class="n">plotdefaults</span><span class="p">(</span><span class="n">ax3</span><span class="p">,</span> <span class="s1">&#39;total&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/programs_dof6sim_31_0.png" src="../_images/programs_dof6sim_31_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># body-frame acceleration cmds</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">moments_data</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">)</span>
<span class="c1"># ax1.set_title(&#39;pitch moment&#39;)</span>
<span class="c1"># ax1.grid()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">moments_data</span><span class="p">)[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">)</span>
<span class="c1"># ax2.set_title(&#39;yaw moment&#39;)</span>
<span class="c1"># ax2.grid()</span>
<span class="n">c4d</span><span class="o">.</span><span class="n">plotdefaults</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="s1">&#39;pitch moment&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">c4d</span><span class="o">.</span><span class="n">plotdefaults</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="s1">&#39;yaw moment&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/programs_dof6sim_32_0.png" src="../_images/programs_dof6sim_32_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># euler angles</span>
<span class="n">missile</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;psi&#39;</span><span class="p">)</span>
<span class="n">missile</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>
<span class="n">missile</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;phi&#39;</span><span class="p">)</span>

<span class="c1"># body rates</span>
<span class="n">missile</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">missile</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
<span class="n">missile</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/programs_dof6sim_33_0.png" src="../_images/programs_dof6sim_33_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/programs_dof6sim_33_1.png" src="../_images/programs_dof6sim_33_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/programs_dof6sim_33_2.png" src="../_images/programs_dof6sim_33_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/programs_dof6sim_33_3.png" src="../_images/programs_dof6sim_33_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/programs_dof6sim_33_4.png" src="../_images/programs_dof6sim_33_4.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/programs_dof6sim_33_5.png" src="../_images/programs_dof6sim_33_5.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># total velocity</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;vx&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;vy&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;vz&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">),</span> <span class="n">V</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;velocity&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/programs_dof6sim_34_0.png" src="../_images/programs_dof6sim_34_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> notebook
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">switch_backend</span><span class="p">(</span><span class="s1">&#39;TkAgg&#39;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">wfig</span><span class="p">,</span> <span class="n">hfig</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span> <span class="o">=</span> <span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="c1"># fig = plt.figure()</span>
<span class="c1"># ax = fig.add_subplot(111, projection=&#39;3d&#39;)</span>

<span class="c1"># X = np.linspace(-5, 5, 100)</span>
<span class="c1"># Y = np.linspace(-5, 5, 100)</span>
<span class="c1"># X, Y = np.meshgrid(X, Y)</span>
<span class="c1"># Z = np.sin(np.sqrt(X**2 + Y**2))</span>

<span class="c1"># Plot the trajectory</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">missile</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="mf">0.3048</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;missile&#39;</span><span class="p">)</span> <span class="c1"># , color = &#39;#2ECC71&#39;) # &#39;#001F3F&#39;) # )</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>  <span class="n">target</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>  <span class="n">target</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="mf">0.3048</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;target&#39;</span><span class="p">)</span> <span class="c1"># , color = &#39;#E74C3C&#39;) # &#39;#FF5733&#39;) # )</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Trajectories&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;X (m)&#39;</span><span class="p">,</span> <span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;Y (m)&#39;</span><span class="p">,</span> <span class="n">zlabel</span> <span class="o">=</span> <span class="s1">&#39;Z (ft)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_zaxis</span><span class="p">()</span>

<span class="c1"># ax.plot_surface(X, Y, Z, cmap=&#39;viridis&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">C4dynamics</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#6-Degrees-Of-Freedom-Example">6 Degrees Of Freedom Example</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#6dof-function">6dof function</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#DCM">DCM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Main-loop">Main loop</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By c4dynamics
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023, c4dynamics.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Nov 17, 2024.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>